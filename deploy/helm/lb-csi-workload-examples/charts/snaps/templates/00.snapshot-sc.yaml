{{- if and (required "snaps.stage field is required" .Values.stage) (eq .Values.stage "snapshot-class")}}
apiVersion: snapshot.storage.k8s.io/v1
kind: VolumeSnapshotClass
metadata:
  name: example-snapshot-sc
driver: csi.lightbitslabs.com
deletionPolicy: Delete
{{- if and .Values.global.storageClass.secretName .Values.global.storageClass.secretNamespace }}
parameters:
  csi.storage.k8s.io/snapshotter-secret-name: {{ .Values.global.storageClass.secretName }}
  csi.storage.k8s.io/snapshotter-secret-namespace: {{ .Values.global.storageClass.secretNamespace }}
  csi.storage.k8s.io/snapshotter-list-secret-name: {{ .Values.global.storageClass.secretName }}
  csi.storage.k8s.io/snapshotter-list-secret-namespace: {{ .Values.global.storageClass.secretNamespace }}
  snapshot.storage.kubernetes.io/deletion-secret-name: {{ .Values.global.storageClass.secretName }}
  snapshot.storage.kubernetes.io/deletion-secret-namespace: {{ .Values.global.storageClass.secretNamespace }}
{{- end }}
{{- end }}
